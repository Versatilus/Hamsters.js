var hamsters=function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(module,exports,__webpack_require__){(function(process,global){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),hamsters=function(){function hamsters(){_classCallCheck(this,hamsters),this.version="4.2.2",this.maxThreads=this.determineGlobalMaxThreads(),this.debug=!1,this.persistence=!0,this.memoize=!1,this.atomics=!1,this.legacy=!1,this.tools={randomArray:this.randomArray,aggregateArrays:this.aggregateThreadOutputs,splitArrays:this.splitArrayIntoSubArrays},this.habitat={browser:this.isBrowser(),worker:this.isWorker(),node:this.isNode(),reactNative:this.isReactNative(),shell:this.isShell(),transferrable:this.supportsTransferrableObjects(),legacy:this.isLegacyEnvironment(),atomics:this.supportsAtomicOperations()},this.pool={uri:null,tasks:[],errors:[],threads:[],running:[],pending:[]},this.run=this.runHamster,this.loop=this.loopAbstraction,this.parseJson=this.parseJsonOnThread,this.stringifyJson=this.stringifyJsonOnThread,this.init=this.initializeLibrary}return _createClass(hamsters,[{key:"isBrowser",value:function(){return"object"===("undefined"==typeof window?"undefined":_typeof(window))}},{key:"isNode",value:function(){return"object"===("undefined"==typeof process?"undefined":_typeof(process))&&!0&&!this.isBrowser()&&!this.isWorker()}},{key:"isWorker",value:function(){return"function"==typeof importScripts}},{key:"isReactNative",value:function(){return!this.isNode()&&"object"===("undefined"==typeof global?"undefined":_typeof(global))}},{key:"isShell",value:function(){return this.isBrowser()&&!this.isNode()&&!this.isWorker()&&!this.isReactNative()}},{key:"supportsTransferrableObjects",value:function(){return"undefined"!=typeof Uint8Array}},{key:"isLegacyEnvironment",value:function(){return this.isShell()||"undefined"==typeof Worker}},{key:"supportsAtomicOperations",value:function(){return"undefined"!=typeof SharedArrayBuffer}},{key:"initializeLibrary",value:function(e){"undefined"!=typeof e&&this.processStartOptions(e),this.habitat.browser&&!this.habitat.reactNative&&this.setupBrowserSupport(),this.habitat.worker&&"undefined"!=typeof SharedWorker&&this.setupWorkerSupport(),(this.habitat.node||this.habitat.reactNative)&&"undefined"!=typeof this.Worker&&(global.Worker=this.Worker),this.habitat.legacy?this.wheel=this.legacyHamsterWheel:(this.wheel=this.hamsterWheel,this.spawnHamsters()),this.chewGarbage(e)}},{key:"isIE",value:function(e){return new RegExp("msie"+(isNaN(e)?"":"\\s"+e),"i").test(navigator.userAgent)}},{key:"determineGlobalMaxThreads",value:function(){var e=4;return"undefined"!=typeof navigator&&"undefined"!=typeof navigator.hardwareConcurrency&&(e=navigator.hardwareConcurrency),navigator.userAgent.toLowerCase().indexOf("firefox")!==-1&&e>20&&(e=20),e}},{key:"setupBrowserSupport",value:function(){("undefined"==typeof Worker||["Kindle/3.0","Mobile/8F190","IEMobile"].indexOf(navigator.userAgent)!==-1||this.isIE(10))&&(this.habitat.legacy=!0)}},{key:"setupWorkerSupport",value:function(){try{var e=this.generateWorkerBlob();new SharedWorker(e,"SharedHamsterWheel");this.pool.uri=e}catch(e){this.habitat.legacy=!0}}},{key:"processStartOptions",value:function(e){for(var t in e)e.hasOwnProperty(t)&&(hamsters[t]=e[t])}},{key:"generateWorkerBlob",value:function(){return URL.createObjectURL(this.createBlob("("+String(this.giveHamsterWork())+")();"))}},{key:"spawnHamsters",value:function(){if(this.habitat.browser&&(this.pool.uri=this.generateWorkerBlob()),this.persistence){var e=this.maxThreads;for(e;e>0;e--)this.pool.threads.push(this.spawnHamster())}}},{key:"spawnHamster",value:function(){return this.habitat.ie10?new Worker("src/common/wheel.min.js"):this.habitat.worker?new SharedWorker(this.pool.uri,"SharedHamsterWheel"):this.habitat.node?new Worker(this.giveHamsterWork()):new Worker(this.pool.uri)}},{key:"giveHamsterWork",value:function(){return this.habitat.worker?this.workerWorker:this.worker}},{key:"createBlob",value:function(e){if(!Blob){var t=BlobBuilder||WebKitBlobBuilder||MozBlobBuilder||MSBlobBuilder,r=new t;return r.append([e],{type:"application/javascript"}),r.getBlob()}return new Blob([e],{type:"application/javascript"})}},{key:"workerWorker",value:function workerWorker(){self.addEventListener("connect",function(e){var port=e.ports[0];port.start(),port.addEventListener("message",function(e){self.params=e.data,self.rtn={data:[],dataType:params.dataType};var fn=eval("("+params.fn+")");fn&&fn(),port.postMessage({results:rtn})},!1)},!1)}},{key:"worker",value:function(){self.typedArrayFromBuffer=function(e,t){var r={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array,uint8clamped:Uint8ClampedArray,int32:Int32Array,int16:Int16Array,int8:Int8Array,float32:Float32Array,float64:Float64Array};return r[e]?new r[e](t):t},self.onmessage=function(e){self.params=e.data,self.rtn={data:[],dataType:params.dataType};var t=new Function(params.fn);t&&t(),params.dataType?(rtn.data=self.typedArrayFromBuffer(params.dataType,rtn.data),postMessage({results:rtn},[rtn.data.buffer])):postMessage({results:rtn})}}},{key:"newTask",value:function(e,t,r,n,a,i){return this.pool.tasks.push({id:e,workers:[],count:0,threads:t,input:[],dataType:n||null,fn:a,output:[],order:r||null,onSuccess:i}),this.pool.tasks[e]}},{key:"legacyHamsterWheel",value:function(e,t,r,n,a,i,s,o){this.trackThread(a,this.pool.running,i),(o||this.debug)&&this.trackInput(e,i,a,t),legacyProcessor(t,e,function(e){this.clean(a,i),a.output[i]=e.data,0===a.workers.length&&a.count===a.threads&&(n(getOutput(a.output,r,e.dataType)),this.pool.tasks[a.id]=null,this.cache&&o!==!1&&o(a.fn,a.input,e.data,e.dataType))}),a.count+=1}},{key:"hamsterWheel",value:function(e,t,r,n,a,i,s,o){return this.maxThreads===this.pool.running.length?void this.poolThread(e,t,i,n,a,r,o):((o||this.debug)&&this.trackInput(e,i,a,t),s||(s=this.persistence?this.pool.threads[this.pool.running.length]:spawnHamster()),this.trainHamster(i,r,n,a,s,o),this.trackThread(a,this.pool.running,i),t.array=e,this.feedHamster(s,t),a.count+=1,void("verbose"===this.debug&&console.info("Spawning Hamster #"+i+" @ "+(new Date).getTime())))}},{key:"chewGarbage",value:function(e){delete this.init,e=null}},{key:"splitArrayIntoSubArrays",value:function(e,t){var r=0,n=[],a=Math.ceil(e.length/t);if(e.slice)for(;r<e.length;)n.push(e.slice(r,r+=a));else for(;r<e.length;)n.push(e.subarray(r,r+=a));return n}},{key:"loopAbstraction",value:function loopAbstraction(input,onSuccess){var params={run:this.prepareFunction(input.operator),init:input.startIndex||0,limit:input.limit,array:input.array,incrementBy:input.incrementBy||1,dataType:input.dataType||null,worker:this.habitat.worker};this.runHamster(params,function(){var operator=params.run;"string"==typeof operator&&(operator=params.worker?eval("("+operator+")"):new Function(operator)),params.limit||(params.limit=params.array.length);var i=params.init;for(i;i<params.limit;i+=params.incrementBy)rtn.data[i]=operator(params.array[i])},function(e){onSuccess(e)},input.threads,1,input.dataType)}},{key:"prepareFunction",value:function(e){if(!this.habitat.legacy&&(e=String(e),!this.habitat.worker)){var t=e.indexOf("{")+1,r=e.length-1;return e.substring(t,r)}return e}},{key:"parseJsonOnThread",value:function(e,t){this.runHamster({input:e},function(){rtn.data=JSON.parse(params.input)},function(e){t(e[0])},1)}},{key:"stringifyJsonOnThread",value:function(e,t){this.runHamster({input:e},function(){rtn.data=JSON.stringify(params.input)},function(e){t(e[0])},1)}},{key:"runHamster",value:function(e,t,r,n,a,i,s,o){if(!e||!t)return"Error processing for loop, missing params or function";n=this.habitat.legacy?1:n||1,i&&(i=i.toLowerCase());var u=this.newTask(this.pool.tasks.length,n,o,i,t,r);if(this.cache&&s){var l=checkCache(t,u.input,i);if(l&&r)return void setTimeout(function(){this.pool.tasks[taskid]=null,r(l)},4)}this.work(u,e,t,r,a,i,s,o)}},{key:"randomArray",value:function e(t,r){for(var e=[];t>0;)e.push(Math.round(99*Math.random()+1)),t-=1;r(e)}},{key:"aggregateThreadOutputs",value:function(e,t){if(!t||!this.habitat.transferrable)return e.reduce(function(e,t){return e.concat(t)});var r=0,n=e.length,a=0;for(r;r<n;r+=1)a+=e[r].length;var i=this.processDataType(t,a),s=0;for(r=0;r<n;r+=1)i.set(e[r],s),s+=e[r].length;return i}},{key:"checkCache",value:function(e,t,r){var n=this.cache[e];if(n&&n[0]===t&&n[2]===r)return n}},{key:"memoize",value:function(e,t,r,n){this.cache[e]=[t,r,n]}},{key:"sort",value:function(e,t){switch(t){case"desc":case"asc":return Array.prototype.sort.call(e,function(e,r){return"asc"===t?e-r:r-e});case"ascAlpha":return e.sort();case"descAlpha":return e.reverse();default:return e}}},{key:"work",value:function(e,t,r,n,a,i,s,o){var u=t.array;u&&1!==e.threads&&(u=this.splitArrayIntoSubArrays(u,e.threads));var l={},h=void 0;for(h in t)t.hasOwnProperty(h)&&"array"!==h&&(l[h]=t[h]);l.fn=this.prepareFunction(r),l.dataType=i;for(var c=0;c<e.threads;)u&&1!==e.threads?this.wheel(u[c],l,a,n,e,e.count,null,s):this.wheel(u,l,a,n,e,e.count,null,s),c+=1}},{key:"assignOutput",value:function(e,t){e&&t&&this.habitat.atomics&&(e.output=new SharedArrayBuffer(t.length))}},{key:"trackInput",value:function(e,t,r,n){r.input.push({input:e,workerid:t,taskid:r.id,params:n,start:(new Date).getTime()})}},{key:"trackThread",value:function(e,t,r){e.workers.push(r),this.pool.running.push(r)}},{key:"poolThread",value:function(e,t,r,n,a,i,s){this.pool.pending.push({memoize:s,input:e,params:t,workerid:r,onSuccess:n,task:a,aggregate:i})}},{key:"legacyProcessor",value:function(e,t,r){setTimeout(function(){var e={success:!0,data:[]},n=n;n.array=t,n.fn(),n.dataType&&"na"!=n.dataType&&(e.data=this.processDataType(n.dataType,e.data),e.dataType=n.dataType),r(e)},4)}},{key:"getOutput",value:function(e,t,r){return t&&e.length<=20?this.aggregateThreadOutputs(e,r):e}},{key:"processQueue",value:function(e,t){t&&this.wheel(t.input,t.params,t.aggregate,t.onSuccess,t.task,t.workerid,e,t.memoize)}},{key:"clean",value:function(e,t){this.pool.running.splice(this.pool.running.indexOf(t),1),e.workers.splice(e.workers.indexOf(t),1)}},{key:"trainHamster",value:function(e,t,r,n,a,i){var s=this,o=function(i,o){if(s.clean(n,e),o=i.data.results,n.output[e]=o.data,"verbose"===this.debug&&console.info("Hamster #"+e+" finished @ "+i.timeStamp),0===n.workers.length&&n.count===n.threads){var u=s.getOutput(n.output,t,n.dataType);r(n.order?sort(u,n.order):u),this.debug&&console.info("Execution Complete! Elapsed: "+(i.timeStamp-n.input[0].start)/1e3+"s"),s.pool.tasks[n.id]=null}0!==s.pool.pending.length?s.processQueue(a,s.pool.pending.shift()):s.persistence||s.habitat.worker||a.terminate()},u=function(t){s.habitat.worker||a.terminate(),s.pool.errors.push({msg:"Error Hamster #"+e+": Line "+t.lineno+" in "+t.filename+": "+t.message}),console.error("Error Hamster #"+e+": Line "+t.lineno+" in "+t.filename+": "+t.message)};this.habitat.worker?(a.port.onmessage=o,a.port.onerror=u):(a.onmessage=o,a.onerror=u)}},{key:"processData",value:function(e,t){var r={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array,uint8clamped:Uint8ClampedArray,int32:Int32Array,int16:Int16Array,int8:Int8Array,float32:Float32Array,float64:Float64Array};return r[e]?new r[e](t):e}},{key:"processDataType",value:function(e,t){return this.habitat.transferrable?this.processData(e,t):t}},{key:"feedHamster",value:function(e,t){if(this.habitat.worker)return e.port.postMessage(t);if(this.habitat.ie10)return e.postMessage(t);var r=[],n=void 0;for(n in t)t.hasOwnProperty(n)&&t[n]&&t[n].buffer&&r.push(t[n].buffer);return e.postMessage(t,r)}}]),hamsters}();module.exports=new hamsters}).call(exports,__webpack_require__(2),function(){return this}())},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function a(e){if(h===setTimeout)return setTimeout(e,0);if((h===r||!h)&&setTimeout)return h=setTimeout,setTimeout(e,0);try{return h(e,0)}catch(t){try{return h.call(null,e,0)}catch(t){return h.call(this,e,0)}}}function i(e){if(c===clearTimeout)return clearTimeout(e);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function s(){y&&f&&(y=!1,f.length?d=f.concat(d):m=-1,d.length&&o())}function o(){if(!y){var e=a(s);y=!0;for(var t=d.length;t;){for(f=d,d=[];++m<t;)f&&f[m].run();m=-1,t=d.length}f=null,y=!1,i(e)}}function u(e,t){this.fun=e,this.array=t}function l(){}var h,c,p=e.exports={};!function(){try{h="function"==typeof setTimeout?setTimeout:r}catch(e){h=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(e){c=n}}();var f,d=[],y=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new u(e,t)),1!==d.length||y||a(o)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}}]);
//# sourceMappingURL=hamsters.min.js.map